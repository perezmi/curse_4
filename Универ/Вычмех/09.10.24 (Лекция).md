# Тема: Решение СЛАУ методом QR разложения (метод отражений, или метод Хаусхофера)
## 1. $QR$ разложение
$A=QR$
$Q$- ортогональная матрица ($Q^{T}=Q^{-1}$)
$R=\begin{bmatrix}r_{11}&\dots&r_{n1}\\\vdots&\ddots&\vdots\\0&\dots&r_{nn}\end{bmatrix}$ 
1. $Qy=b=>y=Q^{T}b^{y}$
2. $Rx=y$ - система матр
$QR$ существует для любой матрицы А 
$A_{m*n}=Q_{m*m}R_{m*n}$
Разложение не единственно
Мы же рассмотрим только один метод для расчета этого разложения
## 2. Матрица отражения (Хаусхолдера)
Представим, что у нас в некотором пространстве есть пространство и вектор, который нужно отразить относительно него
![[Drawing 2024-10-09 11.24.53.excalidraw]]
$\overline{a}*=H*\overline{a}$
$H=I-\frac{2\overline{u}\overline{u}^T}{\overline{u}^T\overline{u}}$
$\overline{a}*=\overline{a}-\overline{u}\frac{2\overline{u}^T\overline{a}}{\overline{u}^T\overline{u}}-\overline{u}\frac{2\overline{u}^T\overline{a}}{\overline{u}^T\overline{u}}=\overline{a}_1-\overline{a}_{11}$
$H$- матрица отражений
### Основные свойства матрицы отражений:
#### 1. $H$ - ортогональная матрица:
$||Ha||_{2}=||a||_{2}$
$a^{T}a=(Ha)^{T}Ha=a^{T}H^{T}Ha$
#### 2. Матрица $H$ симметричная:
$H=H^T$ по определению
#### 3. Матрица инверсивна (сама себе обратна):

$H=H^{-1}$ из пункта 2
#### 4. Матрица отражений $H_{n*n}$ имеет $(n-1)$ собственных значений, равных $1$, и одно, равное $-1$
$Hv=k*v$ 
	$k$-собственное значение
$Hu=-u$
	$u$ - собственный вектор
	$k=-1$ - собственный вектор
#Бля я тут не понял нифига
#### 5. $det\ H=-1$ - не является собственно ортогональной
$det\ H=k_{1}*k_{2}*\dots*k_{n}=-1*1*\dots*1$ 
### Рациональный способ разложения -Умножение матриц Хаусхофера
$Ha=(I-\frac{2\overline{u}\overline{u}^T}{\overline{u}^T\overline{u}})a=a-\frac{2\overline{u}\overline{u}^{T}{a}}{\overline{u}^T\overline{u}}=a-\lambda{u}$
$K=\frac{u^{T}u}{2};\ \lambda=\frac{u^{T}a}{K}$
### Задача об обнулении подвектора:
$a=\begin{bmatrix}a_{1}\\\vdots\\a_{j-1}\\a_{j}\\a_{j+1}\\\vdots\\a_{n}\end{bmatrix}->\begin{bmatrix}a_{1}\\\vdots\\a_{j-1}\\???\\0\\\vdots\\0\end{bmatrix}=a*=Ha$
$u=\begin{bmatrix}0\\\vdots\\0\\a_{j}+S\\a_{j+1}\\\vdots\\a_{n}\end{bmatrix}$ 
где $s=\sigma*\sqrt{\sum^{n}_{i=j}a^2_i}$  и $\sigma=+1,a_{j}\geq{0}; -1,a_{j}<0$ 
#### Доказательство:
$Ha=a-\lambda{u}$
$K=\frac{u^{T}u}{2}=\frac{1}{2}\sum^{n}_{i=1}u^{2}_{i}=\frac{1}{2}((a_{j}+S)^{2}+a^2_{j+1}+\dots+a^{2}_{n})=\frac{1}{2}(S^{2}+2a_{j}S+a_{j}^{2}+a^{2}_{j+1}+\dots+a^{2}_{n})=S*(S+a_{j})$
$u^{T}a=a_{j}(a_{j}+S)+a^{2}_{j+1}+\dots+a^{2}_{n}=a_{j}S+S^{2}=S(a_{j}+S)$ 
$\lambda=\frac{u^T}{K}=\frac{S(a_{j}+S)}{S(a+j +S)}=1$ 
#### Пример:
Занулим этот вектор:
$$a=\begin{bmatrix}8\\15\\44\\-3\\37\\-69\end{bmatrix}->\begin{bmatrix}0\\15\\0\\0\\37\\??\end{bmatrix}=a*$$
Все дальше делалось на компе [сорян]
### 4. Решение СЛАУ методом отражений и построение QR разложения матрицы
1. Подбираем матрицу $H1$ так, чтобы поддиагональные элементы матрицы $A$ обнулялись:
	%% ![[Drawing 2024-10-09 12.16.29.excalidraw]]%%
	#Бля вот фото лучше, позже перепиши
	![[Pasted image 20241009193834.png]]
	$R=H_{n-1}\dots{H}_{2}H_{1}A$ 
	Т.к. $QR=A$
	$Q=(H_{n-1}\dots{H}_{2}H_{1})^{T}$
	Дальнейшее решение - по инструкции
	Замечание 1:
		Матрицы $H_{j}$ имеют следующую структуру:
		$H_{j}=\begin{bmatrix}I_{j-1}&0\\0&\widetilde{H}_{j}\end{bmatrix}$ 
		$\widetilde{H}_{j}=I-\frac{2\overline{u}\overline{u}^T}{\overline{u}^T\overline{u}}$ 
	Замечание 2:
		При выполнении умножения на $H_j$ следует оставить без изменения первые $(j-1)$ элементы столбца, а нижнюю часть умножить на $\widetilde{H}_{j}$ рациональным способом