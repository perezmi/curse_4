Собственно, на прошлый занятиях мы поговорили про якобиан
Якобиан определяет систему линейный уравнений:
$$J*\dot{q}=u$$
По сути, это прямая задача кинематики - найти по известным $q$ найти выходные параметры

Обратная же задача заключается в обратном, найти $q$ по требуемым для траектории выходным параметрам. Вся эта задача выходит в обычное решение СЛАУ:
1. $J$ без избыточности - сработают обычны методы типа LU разложения с частичным выбором ведущего элементов
2. $J$ избыточен (m\*n элементов, m<n) - методы решения СЛАУ с прямоуглольными матрицами
3. Конфигурация близка к сингулярной
#Бля фото 11:34
#Бля таблицу нахуй отсюда перепиши аутлайном

| LU разложение без выбора                                                                                                                                                                                                                                                         | С частичным выбором ведущего элемента                                                                                                                                                                                                                                                                                                         |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| $$A=LU$$<br>$$L=\begin{bmatrix}1&0&0\\l_{ij}&1&0\\l_{ij}&l_{ij}&1\end{bmatrix}$$<br>$$U=\begin{bmatrix}u_{11}&u_{23}&u_{13}\\0&u_{22}&u_{23}\\0&0&u_{33}\end{bmatrix}$$<br>1.$j=1\dots n,\ i=1\dots j-1$$$u_{ij}=a_{ij}-\sum_{k=1}^{i-1}{l_{ik}u_{kj}}$$<br>2. $i=j$$$u_{ij}= $$ | $PA=LU$$<br>где $P$ - матрица перестановки<br>Матрицы $L$ и $U$ остаются такими же.<br>1.$j=1\dots n,\ i=1\dots j-1$<br>$$u_{ij}=a_{ij}-\sum_{k=1}^{i-1}{l_{ik}u_{kj}}$$<br>2. $i=j\dots n$<br>$\widetilde{u}_{ij}=a_{ij}-\sum\limits^{j-1}_{k=1}{l_{ik}u_{kj}}$<br><br>3. $t:\|\widetilde{u}_{tj}\|=max\widetilde{u}_{ij},\ j\leq{i}\leq{n}$ |
Пример:
$$
A=\begin{bmatrix} 1&2&3\\4&5&6 \\7&8&10 \end{bmatrix}
$$
$$
b=\begin{bmatrix} 10 \\ 28 \\ 47\end{bmatrix}
$$

$$'LU'=\begin{bmatrix} 1&2&3\\4&5&6 \\7&8&10 \end{bmatrix}$$
1. Вычисляем полуфабрикаты:
   $$
   \begin{align}
   \widetilde{u}_{11}=a_{11}-\sum_1^0=1\\
   \widetilde{u}_{21}=a_{21}-\sum_1^0=4\\
   \widetilde{u}_{31}=a_{31}-\sum_1^0=7
   \end{align}$$
   %комментарий - здесь и дальше суммы в этих формулах тупо уходят в нуль%
   Переставляем строки с максимальным элементом наверх:
   $$'LU'=\begin{bmatrix} 7&8&10\\4&5&6\\1&2&3  \end{bmatrix}$$
   и $\widetilde{u}_{11}$ теперь ведущий элемент
4. $l_{21}=\frac{\widetilde{u}_{21}}{u_{11}}=\frac{4}{7}$
   $l_{31}=\frac{\widetilde{u}_{31}}{u_{11}}=\frac{1}{7}$ 
   $$'LU'=\begin{bmatrix} 7&8&10\\4/7&5&6\\1/7&2&3  \end{bmatrix}$$
$j=2$
$$\begin{align}u_{12}=a_{12}-\sum=8\\u_{22}=a_{22}-\sum=\frac{3}{7}\\u_{32}=a_{32}-\sum=\frac{6}{7}\end{align}$$
 $$'LU'=\begin{bmatrix} 7&8&10\\4/7&3/7&6\\1/7&6/7&3  \end{bmatrix}$$
 Дальше выбираем ведущий элемент минора $j=2$ - $u_{32}$
 Перестановка:
 $$'LU'=\begin{bmatrix} 7&8&10\\1/7&6/7&3\\4/7&3/7&6  \end{bmatrix}$$
 $l_{32}=\frac{\widetilde{u_{32}}}{u_{22}}=1/2$
  По итогу получаем:
 
 $$'LU'=\begin{bmatrix} 7&8&10\\1/7&6/7&3\\4/7&1/2&6  \end{bmatrix}=
 \begin{bmatrix} u11&u12&10\\l23&u22&3\\l13&l23&6  \end{bmatrix}$$
Остальные цифры - огрызки матрицы $A$
С ними все проще: 
${u}13=a13-\sum=10$ 
$u23=a23-l21u13=\frac{11}{7}$
$\widetilde{u}33=a33-l31u13-l32u23=-\frac{1}{2}$ 
 $$'LU'=\begin{bmatrix} 7&8&10\\1/7&6/7&11/7\\4/7&1/2&-1/2  \end{bmatrix}= \begin{bmatrix} u11&u12&u13\\l23&u22&u23\\l13&l23&u33  \end{bmatrix}$$
 Мы нашли $U$ и $L$
 Теперь рассмотрим решение:
 1. $L\overline{y}=Pb$
Переставим элементы в $b$ согласно перестановкам из поиска $'LU'$
$b=\begin{bmatrix} 10 \\ 28 \\ 47\end{bmatrix}\mapsto\ b=\begin{bmatrix} 47 \\ 28 \\10 \end{bmatrix}\mapsto\ b=\begin{bmatrix} 47 \\ 10 \\ 28\end{bmatrix}$
2. Решаем систему:
$y1=47$
$1/7*y1+y2=10\mapsto\ y2=23/7$
$4/7*y1+1/2*y2+y3=28\mapsto\ y3=$
3. $Ux=y$
$7*x1$
#Бля фото 12:18

## Матрица перестановок
**Матрица перестановок** - матрица, после умножения на которую в исходной матрице меняется порядок строк
$P*\begin{bmatrix}1\\2\\3\\4\end{bmatrix}=*\begin{bmatrix}1\\3\\4\\2\end{bmatrix}$
Матрица транспозициименяет местами I и j

### Как получить матрицу перестановок в методе LU разложения?

Матрица перестановок может быть найдена как произведение матрицы транспозиции
$P=P_{n-1}\dots P_2P_1$
Восстановим это все из примера:
Перестановка 1 и 3 строки:
$$P_{13}=\begin{bmatrix}0&0&1\\0&1&0\\1&0&0\end{bmatrix}$$
Перестановка 2 и 3 строк:
$$P_{23}=\begin{bmatrix}1&0&0\\0&0&1\\0&1&0\end{bmatrix}$$
Конечная матрица:
$$P=P_{23}*P_{13}=\begin{bmatrix}0&0&1\\1&0&0\\0&1&0\end{bmatrix}$$
Некоторые свойства матриц перестановок:
1. $P$ - ортогональная матрица. Для матрицы обратной перестановки можно просто транспонировать оригинальную матрицу перестановки
2. Матрица транспозиционная