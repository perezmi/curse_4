# Тема: управление неполноприводными системами (underactuated robots)
- когда мы рассматриваем манипулятивные платформы, то они считаются полноприводными
- полноприводными мы будем называть те системы, у которых на каждую степень свободы приходится один привод
- *размерность вектора состояния = размерность вектора управления*
- в таких системах можно
	- управлять каждой степенью свободы отдельно
	- измерять всю необходимую информацию с датчиков без сложных вычислений (т.е. в манипуляторе на каждое звено идет отдельный датчик и не надо проводить отдельные вычисления)
В то же время неполноприводная система:
- число степеней свободы>число приводов
- *размерность вектора состояния>размерность вектора управления*
- то есть, на каждую степень свободы не получится сделать отдельное управление
- невозможно измерять переменные состояния для каждой степени свободы в большинстве случаев
## Примеры неполноприводных систем:
- сигвеи (3 тела - колесо, сигвей и пассажир. 2 привода, а степеней свободы )
- балансирующие роботы
- гироскутеры
- та поделка с большим шаром и 3 продольно-роликовыми колесами
- одноколесные ТС (моноколеса)
- шагающие роботы
- устройства захвата
- роботы-птицы
- некоторые параллельные манипуляторы
## Особенности неполноприводных систем как САУ:
- неустойчивость
- дефицит управляющих воздействий
- дефицит измеряемых параметров
## Особенности синтеза управления
- расчетная мдоель системы
	- нужно сразу переходить на уровень динамики
	- они будут нелинейными и возиться с ними долго, неприятно и тяжело
	- не все виды движения способны реализовывать устойчивое движение
		- пример - ускориться на сигвее можно лишь наклонившись вперед
	- поэтому, можно и нужно линеаризовать уравнения движения в некоторой области
- исследование управляемости системы
- исследование наблюдаемости системы
	- можно ли по измеряемым данным восстановить полную конфигурацию системы - если по русски
- синтез закона управления
	- метод модального управления (метод размещения полюсов)
	- метод квадратичной линейной стабилизации
- оценка вектора состояния системы
	- по русски - процесс восстановления конфигурации
### Методы синтеза управления
- модальная стабилизация
- оптимальная стабилизация
- адаптивное управления
- нейросетевые алгоритмы управления
## 1. Линеаризация уравнений динамики неполноприводных систем
уравнение движения для случая двух степеней свободы:
$$\begin{bmatrix}
F1(\ddot{q_{1}},\ddot{q_{2}},\dot{q_{1}},\dot{q_{2}},q_{1},q_{2},U)\\ 
F2(\ddot{q_{1}},\ddot{q_{2}},\dot{q_{1}},\dot{q_{2}},q_{1},q_{2},U)
\end{bmatrix}$$
Программный режим движения $q_{i}^{*}(t)$
Программный режим движения не является произвольным, оно должно согласовываться с уравнением движения
Линеаризация просиходит следующим образом:
- должны существовать управления $U^{*}$, соответствующие программному движению $q^{*}$ и уравнениям динамики
- структура линеаризованных уравнений такова:
	- введем вектор отклонения обобщенных координат от программного движения:
		- $\Delta q=q-q^{*}$
		- $\Delta\dot q=\dot q-\dot q^{*}$
		- $\Delta\ddot q=\ddot q-\ddot q^{*}$
		- $u=U-U^*$
	- $M\Delta\ddot q+V\Delta\dot q+P\Delta q+Gu=0$
	- Матрицы получаем дифференцированием $F1$ и $F2$
		- $M=\begin{bmatrix}\frac{\partial F_1}{\partial \ddot q_{1}}&\frac{\partial F_1}{\partial \ddot q_{2}}\\\frac{\partial F_2}{\partial \ddot q_{1}}&\frac{\partial F_2}{\partial \ddot q_{2}}\end{bmatrix}=M^T>0$ 
		- $V=\begin{bmatrix}\frac{\partial F_1}{\partial \dot q_{1}}&\frac{\partial F_1}{\partial \dot q_{2}}\\\frac{\partial F_2}{\partial \dot q_{1}}&\frac{\partial F_2}{\partial \dot q_{2}}\end{bmatrix}=M^T>0$
		- $P=M=\begin{bmatrix}\frac{\partial F_1}{\partial q_{1}}&\frac{\partial F_1}{\partial q_{2}}\\\frac{\partial F_2}{\partial q_{1}}&\frac{\partial F_2}{\partial q_{2}}\end{bmatrix}=M^T>0$
		- $G=M=\begin{bmatrix}\frac{\partial F_1}{\partial u}\\\frac{\partial F_2}{\partial u}\end{bmatrix}$
		- $M,V,P$ могут зависеть от времени
		- $\dot X=Ax+Bu$
		- $X=\begin{bmatrix}\Delta q\\\Delta\dot q\end{bmatrix}$ 
	- Дальше Коши:
		- $\frac{d}{dt}\Delta q=\Delta \dot q$
		- $\frac{d}{dt}\Delta\dot q=\Delta \ddot q=-M^{-1}(V\Delta\dot q +P\Delta q+ Gu)$ 
		- Получаем $\dot{\begin{bmatrix}\Delta q\\\Delta\dot q\end{bmatrix}}=\begin{bmatrix}0&I\\-M^{-1}P&-M^{-1}V\end{bmatrix}\begin{bmatrix}\Delta q\\\Delta\dot q\end{bmatrix}+\begin{bmatrix}0\\-M^{-1}G\end{bmatrix}u=\dot X=A(t)*X+B(t)u$ 
		- $\begin{bmatrix}\dot X=Ax+Bu\ -\ динамика\ объекта\ управления\\y=Cx+Du\ -\ модель\ измерений\end{bmatrix}$ 
		- $n>m$
		- $l<n$
	- Дальше посмотрим, возможно ли вообще решить эту задачу
		- для стабилизации движения в общем случае используется обратная связь по вектору состояния
			- $u=-kx=-k_{1}\Delta q_{1}-k_{2}\Delta q_{2}-k_{3}\Delta\dot q_{1}-k_{4}\Delta\dot q_{2}$
		- Можно ли стабилировать (регулировать) #бля => исследование на управление
		- Можно ли по существующим измерениям восстановить все элементы вектора $X$? => исследование наблюдаемости
## 2. Понятие об управляемости линейных систем
**Определение:**
Система $\dot X=AX+Bu$ называется вполне управляемой, если мы можем каким угодно образом менять ее состояние с помощью ограниченного управления: 
	для любого $X(t_0)=X_{0}$ существует ограниченное управление $u$, переводящее ее в произвольное заданное терминальное состояние $X_{1}=X(t_{1})$  (управление на отрезке $[t_{0},t_{1}]$
Если $A,B=const$, то:
1. они управляемы на любом отрезке времени
2. Критерий управляемости Калмана:
	#бля загугли напиши
	![[Универ/УМРУ/фото/30.10.24/фото 10:30.jpg]]
Если ранг матрицы $m=1$, то матрица калмана будет квадратной =>$det\ C\ne0$ 
## 3. Понятие о наблюдаемости системы
*Определение:* Система управления $\dot x=Ax+Bu$ с измерениями $y=Cx$ называется вполне наблюдаемой на отрезке $[t_{0},\tau_{(текущее)}]$, если по измерениями $y(\tau)$ и известному правлению $u(\tau)$ можно точно восстановить состояние $x(t)$ 
![[Drawing 2024-10-30 10.36.14.excalidraw]]
Естественно, здесь тоже есть свой критерий Калман
При $A,C=const$
1. свойство наблюдаемости не зависит от промежутка $[t_0,t]$
	   система будет наблюдаема на любом промежутке времени
2. Справедлив критерий наблюдаемости Калмана
	![[Универ/УМРУ/фото/30.10.24/фото 10:42.jpg]]
	$Rg\ O=n<=>det\ O(A,C)\ne0$
### Теоретический способ получения оценки $\hat X$, приводящий к критерию Калмана
$$\dot X=AX$$
$$y=CX$$
Объект просто живет своей жизнью, возьмем пример без управления
$$\dot y=CA\dot x$$
$$\ddot y =CA^2\ddot x$$
$$\vdots$$
$$y^{'n-1}=Cx^{'n-1}=CA^{n-1}x$$
Получаем:
$$
\begin{bmatrix}
C\\CA\\CA^2\\\vdots\\CA^{n-1}
\end{bmatrix}x=\begin{bmatrix}
y\\\dot y\\\ddot y\\\vdots\\y^{'n-1}
\end{bmatrix}
$$
И получаем задачу МНК
Решение существует если $Rg\ O(A,C)=n$
Так же на какой-то производной могут остаться одни погрешности
Для решения этой проблемы существуют различные фильтры, но фильтр Калмана мы рассмотрим позже
