# Тема: Навигация мобильной меканум платформы
Метод, который мы изучали для управления платформой, странный, тк работает без ОС
## Навигация мобильных платформ это:
	*В старом понимании:* исключительно одна задача - построить маршрут из т. А в т. Б, в основном используется для судоходства и тд
	*В новом понимании:* определение некоторого подвижного средства в пространстве. x,y,z - уже хорошо, углы поворотов - вообще замечательно
В части с построением маршрутов иди в теорию графов, там было
А так, в современном мире рабочие системы навигации это:
- спутники (GPS, ГЛОНАСС и тд)
  ![[Drawing 2024-09-18 09.33.07.excalidraw]]
	тогда мнимое расстояние до каждого спутника:  
	$$
\rho_i=\Delta{t_i*c}+\delta{\rho_i}=\sqrt{(x_i-x)^2+(y_i-y)^2+(z_i-z)^2}+\delta{\rho_i}
$$
- дальномерная навигация (то же самое, что и спутники, только локальные системы навигации)
- Навигация по карте, SLAM (одновременная локализация и построение карты, например с использованием инфракрасного 3D-сканера)
- Динамическая навигация с определением препятствий в пространстве (в т.ч. подвижных) по информации с камер
- Инерциальная навигация (по гироскопу и акселерометру)
	![[Drawing 2024-09-18 09.45.58.excalidraw]]
	Гироскоп - тело на пружинах в одной плоскости на перпендиуклярных осях. Из-за эффекта #Кореолиса возникают колебания, которые пропорциональны скорости вращения вокруг чувствительной оси
	Акселерометр - тело на пружинах. Обычно ставятся по всем 3 осям, измеряют кажущееся ускорение вдоль каждой из них
	$$
	\begin{matrix}
	\overline{n}=\overline{w}*\overline{g}\\
	\overline{n}+\overline{g}=\overline{w}->\iint->\overline{r}
	\end{matrix}
$$
- одометрия (оценка местоположения по информации о взаимном движении составных частей робота)
- визуальная одометрия (оценка положения и ориентации)
- комплексная навигация
## Рассмотрим одометрию на youbot
![[YrX3DWOaw_0.jpg]]
План следующий:
1. снимаем показатели скоростей колес
2. Проводим мат расчеты и получаем скорости V_x,V_y и Omega
$$
\begin{matrix}
\dot{\phi_1}=\frac{1}{R}[V_L-V_T-(l+h)\Omega]\\
\dot{\phi_2}=\frac{1}{R}[V_L+V_T+(l+h)\Omega]\\
\dot{\phi_3}=\frac{1}{R}[V_L+V_T-(l+h)\Omega]\\
\dot{\phi_4}=\frac{1}{R}[V_L-V_T-(l+h)\Omega]
\end{matrix}
$$
или
$$
\begin{matrix}
\dot{\varphi_i}=H*v,
&H=\frac{1}{R}\begin{bmatrix}
1&-1&-l-h\\ 1&1&l+h\\1&1&-l-h\\1&-1&l+h 
\end{bmatrix},&
v=\begin{bmatrix}
V_L\\V_T\\\Omega
\end{bmatrix}
\end{matrix}
$$
модель измерения датчиков поворота колес:
$$
\dot{\varphi_S}=H*v+\varepsilon
$$
где fi_S - показания датчиков, а eps - погрешности на проскальзывания
Решаем методом МНК все это:
$$
\begin{matrix}
H^TH\hat{v}=H^T\dot{\varphi_S},&\hat{v}=H*\dot{\varphi_S}
\\
H^TH=\frac{1}{R^2}
\begin{bmatrix}
4&0&0\\0&4&0 \\0&0&4(l+h) 
\end{bmatrix}, & 
[H^TH]^{-1}=\frac{R^2}{4}
\begin{bmatrix}
1&0&0\\0&1&0 \\0&0&\frac{1}{(l+h)^2} 
\end{bmatrix}
\end{matrix}
$$
Получаем:
$$
\begin{matrix}
\hat{V_L}=\frac{R}{4}(\dot\varphi_{S1}+\dot\varphi_{S2}+\dot\varphi_{S3}+\dot\varphi_{S4})
\end{matrix}
$$
3. Переводим в неподвижную СК и интегрируем:
$$
\begin{matrix}
\hat{V_x}=\hat{V_L}*\cos\hat\Psi+\hat{V_T}*\sin\hat\Psi\\
\hat{V_y}=\hat{V_T}*\cos\hat\Psi+\hat{V_L}*\sin\hat\Psi
\end{matrix}
$$
$$\begin{matrix}
X_{i}=X_{i-1}+\hat{V_x}*\Delta{t}\\
Y_{i}=Y_{i-1}+\hat{V_y}*\Delta{t}\\
\Psi_{i}=\Psi_{i-1}+\hat{\Omega}*\Delta{t}\\
\end{matrix}
$$

4. profit
Единственное, данные с энкодеров - реальные, в них много погрешностей и проскальзываний
## Траекторное управление
Постановка задачи: Обеспечить движение платформы по заданному закону:
$$
\begin{matrix}
x_0^*=x_0^*(t)\\y_0^*=y_0^*(t)\\\Psi^*=\Psi^*(t)
\end{matrix}
$$
Мы задаем управление так, чтобы ошибки позиционирования нас устраивали:
$$
\begin{matrix}
\dot{e}_x=-K_xe_x&\dot{e}_y=-K_ye_y&\dot{e}_{\Psi}=-K_{\Psi}\Psi_x\\ 
K_i->\infty
\end{matrix}
$$
![[Pasted image 20240918103923.png]]
Мы получили, по сути, лишь только наши хотелки (D-Desired). Выражаем желаемые скорости колес:
![[Pasted image 20240918105141.png]]

Подаем хотелки на колеса и получаем данные от энкодеров. Стабилизируем![[Pasted image 20240918105121.png]]
![[Pasted image 20240918105101.png]]